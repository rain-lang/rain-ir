/*!
Naive depth-first search, relying on a filter to reject already-seen elements
*/